<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.sakila.mapper.StoreMapper">
	
	<!-- store 상세정보 -->
	<select id="selectStoreList" parameterType="Map">
			select 
				t.store_id storeId,
				t.manager_staff_id managerStaffId,
			    t.address_id addressId,
			    t.staff_id staffId,
			    t.first_name firstName,
			    t.last_name lastName,
			    t.email email,
			    t.username username,
			    a.address address,
			    a.district district,
			    a.city_id cityId,
			    a.postal_code postalCode,
			    a.phone phone
			from address a inner join (select 
					st.store_id,
					st.manager_staff_id,
					st.address_id,
					sf.staff_id,
					sf.first_name,
					sf.last_name,
					sf.email,
					sf.username
				from store st left join staff sf
				on st.store_id = sf.store_id) t 
			on a.address_id = t.address_id
	</select>
	
	<insert id="insertStore" parameterType="com.example.sakila.vo.Store" useGeneratedKeys="true" keyProperty="storeId">
		insert into store(
			manager_staff_id,
			address_id
		) values (
			#{managerStaffId}, #{addressId}
		)
	</insert>
</mapper>
